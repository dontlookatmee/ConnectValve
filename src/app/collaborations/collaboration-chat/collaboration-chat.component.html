<div class="main-container">
  <div class="container clearfix">
    <div class="people-list" id="people-list">
      <ul class="list">
        <li class="clearfix">
          <img [src]="toUser?.avatar" alt="avatar" />
          <div class="about">
            <div class="name">{{ toUser?.name }}</div>
            <div class="status">
              <i
                [ngClass]="{
                  online: collaboration?.data.joinedPeople.includes(
                    toUser?.uid
                  ),
                  offline: !collaboration?.data.joinedPeople.includes(
                    toUser?.uid
                  )
                }"
                class="fa fa-circle"
              ></i>
              {{
                collaboration?.data.joinedPeople.includes(toUser?.uid)
                  ? 'online'
                  : 'offline'
              }}
            </div>
          </div>
        </li>

        <li class="clearfix">
          <img [src]="fromUser?.avatar" alt="avatar" />
          <div class="about">
            <div class="name">{{ fromUser?.name }}</div>
            <div class="status">
              <i
                [ngClass]="{
                  online: collaboration?.data.joinedPeople.includes(
                    fromUser?.uid
                  ),
                  offline: !collaboration?.data.joinedPeople.includes(
                    fromUser?.uid
                  )
                }"
                class="fa fa-circle"
              ></i
              >{{
                collaboration?.data.joinedPeople.includes(fromUser?.uid)
                  ? 'online'
                  : 'offline'
              }}
            </div>
          </div>
        </li>
      </ul>
    </div>

    <div class="chat">
      <div class="chat-header clearfix">
        <img [src]="loggedUser?.avatar" alt="avatar" />

        <div class="chat-about">
          <div class="chat-with">{{ loggedUser?.name }}</div>
        </div>
      </div>
      <!-- end chat-header -->

      <div class="chat-history">
        <ul>
          <ng-container *ngFor="let message of messages; let idx = index">
            <ng-container *ngIf="idx % 2 === 0">
              <app-chat-message
                *ngIf="messages.length"
                [name]="messages[idx]?.name"
                [message]="messages[idx]?.message"
                [date]="messages[idx]?.date"
                position="right"
                [isOnline]="
                  collaboration?.data.joinedPeople.includes(toUser?.uid)
                "
              ></app-chat-message>

              <app-chat-message
                *ngIf="messages.length > 1"
                [name]="messages[idx + 1]?.name"
                [message]="messages[idx + 1]?.message"
                [date]="messages[idx + 1]?.date"
                position="left"
                [isOnline]="
                  collaboration?.data.joinedPeople.includes(fromUser?.uid)
                "
              ></app-chat-message>
            </ng-container>
          </ng-container>
        </ul>
      </div>
      <!-- end chat-history -->

      <div class="chat-message clearfix">
        <textarea
          name="message-to-send"
          id="message-to-send"
          placeholder="Type your message"
          rows="3"
        ></textarea>

        <button>Send</button>
      </div>
      <!-- end chat-message -->
    </div>
    <!-- end chat -->
  </div>
  <!-- end container -->

  <script id="message-template" type="text/x-handlebars-template">
    <li class='clearfix'>
      <div class='message-data align-right'>
        <span class='message-data-time'>
          {{time}}, Today
        </span>
        &nbsp; &nbsp;
        <span class='message-data-name'>
          Olia
        </span>

        <i class='fa fa-circle me'></i>
      </div>
      <div class='message other-message float-right'>
        {{messageOutput}}
      </div>
    </li>
  </script>

  <script id="message-response-template" type="text/x-handlebars-template">
    <li>
      <div class='message-data'>
        <span class='message-data-name'>
          <i class='fa fa-circle online'></i>
          Vincent
        </span>
        <span class='message-data-time'>
          {{time}}, Today
        </span>
      </div>
      <div class='message my-message'>
        {{response}}
      </div>
    </li>
  </script>
</div>
